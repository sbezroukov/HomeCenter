# Подробное описание функций

## Вкладка 1: Бэкапы

### Создание бэкапа

**Кнопка:** "Создать бэкап" (зелёная)

**Что делает:**
1. Проверяет что Docker контейнер запущен
2. Проверяет что база данных существует
3. Копирует файл базы данных из контейнера
4. Сохраняет с именем `quiz-YYYYMMDD-HHMMSS.db`
5. Показывает размер созданного бэкапа

**Когда использовать:**
- Перед важными изменениями
- Перед обновлением приложения
- Регулярно (рекомендуется ежедневно)

### Восстановление из бэкапа

**Элементы:** Выпадающий список + кнопка "Восстановить" (красная)

**Что делает:**
1. Запрашивает подтверждение
2. Создаёт бэкап текущей базы (`quiz-before-restore-YYYYMMDD-HHMMSS.db`)
3. Останавливает контейнер
4. Копирует выбранный бэкап в контейнер
5. Запускает контейнер обратно

**Когда использовать:**
- После сбоя или потери данных
- Для отката к предыдущей версии
- При тестировании (откат после тестов)

### Управление бэкапами

**Таблица:** Показывает все бэкапы с информацией

**Кнопки:**
- **Обновить**: Обновляет список бэкапов
- **Удалить выбранный**: Удаляет выбранный в таблице бэкап
- **Очистить старые (>30 дней)**: Удаляет все бэкапы старше 30 дней

---

## Вкладка 2: Docker управление

### Статус контейнера

**Индикатор:** Показывает текущий статус контейнера

**Статусы:**
- ✓ Контейнер запущен и работает (зелёный)
- ✗ Контейнер остановлен (красный)
- Ошибка проверки статуса (оранжевый)

**Кнопка:** "Обновить статус" - проверяет текущий статус

### Остановить контейнер

**Кнопка:** "Остановить контейнер" (красная)

**Команда:** `docker-compose stop`

**Что делает:**
- Останавливает Docker контейнер
- Приложение становится недоступным
- Данные сохраняются

**Когда использовать:**
- Перед обслуживанием
- Перед обновлением
- Для экономии ресурсов

**Время выполнения:** 5-10 секунд

### Запустить контейнер

**Кнопка:** "Запустить контейнер" (зелёная)

**Команда:** `docker-compose start`

**Что делает:**
- Запускает остановленный контейнер
- Приложение становится доступным

**Когда использовать:**
- После остановки
- После сбоя
- После обслуживания

**Время выполнения:** 5-10 секунд

### Перезапустить контейнер

**Кнопка:** "Перезапустить контейнер" (голубая)

**Команды:** `docker-compose stop` + `docker-compose start`

**Что делает:**
- Останавливает контейнер
- Ждёт 2 секунды
- Запускает контейнер обратно

**Когда использовать:**
- После изменения `.env` файла
- При странном поведении приложения
- Для применения конфигурации

**Время выполнения:** 10-15 секунд

### Показать логи

**Кнопка:** "Показать последние 50 строк логов" (жёлтая)

**Команда:** `docker logs --tail 50 homecenter`

**Что делает:**
- Получает последние 50 строк логов контейнера
- Показывает в окне лога

**Когда использовать:**
- При ошибках
- Для диагностики проблем
- Для проверки что приложение работает

**Время выполнения:** 1-2 секунды

---

## Вкладка 3: Сборка приложения

### Путь к проекту

**Поле:** Путь к директории с `docker-compose.yml`

**По умолчанию:** Автоматически определяется относительно приложения

**Кнопка "Обзор":** Позволяет выбрать другую директорию

### Пересобрать (быстро)

**Кнопка:** "Пересобрать (быстро)" (зелёная)

**Команда:** `docker-compose up -d --build`

**Что делает:**
1. Пересобирает Docker образ
2. Перезапускает контейнер
3. Использует кэш Docker для ускорения

**Когда использовать:**
- После изменений в коде
- После изменений в `Dockerfile`
- Для быстрого обновления

**Время выполнения:** 1-2 минуты

**Кэш:** ✅ Используется

### Полная пересборка

**Кнопка:** "Полная пересборка" (голубая)

**Команды:**
1. `docker-compose down`
2. `docker-compose up -d --build`

**Что делает:**
1. Останавливает и удаляет контейнер
2. Пересобирает образ
3. Создаёт и запускает новый контейнер

**Когда использовать:**
- После значительных изменений
- При проблемах с контейнером
- Для "чистой" пересборки

**Время выполнения:** 2-3 минуты

**Кэш:** ✅ Используется

### Пересборка без кэша

**Кнопка:** "Пересборка без кэша" (оранжевая)

**Команды:**
1. `docker-compose build --no-cache`
2. `docker-compose up -d`

**Что делает:**
1. Пересобирает образ БЕЗ использования кэша
2. Скачивает все зависимости заново
3. Компилирует всё с нуля
4. Запускает контейнер

**Когда использовать:**
- При странных ошибках сборки
- При проблемах с зависимостями
- После обновления .NET SDK
- Когда кэш "испорчен"

**Время выполнения:** ⚠️ 5-10 минут

**Кэш:** ❌ НЕ используется

**Предупреждение:** Это медленная операция!

### Обновить базовые образы

**Кнопка:** "Обновить базовые образы" (светло-голубая)

**Команды:**
1. `docker-compose pull`
2. `docker-compose up -d --build`

**Что делает:**
1. Скачивает последние версии базовых образов:
   - `mcr.microsoft.com/dotnet/aspnet:8.0`
   - `mcr.microsoft.com/dotnet/sdk:8.0`
2. Пересобирает приложение с новыми образами
3. Запускает контейнер

**Когда использовать:**
- Раз в месяц (для обновлений безопасности)
- После выхода новых версий .NET
- Для получения исправлений

**Время выполнения:** 3-5 минут (зависит от скорости интернета)

**Кэш:** ✅ Используется для приложения

### Очистить старые образы

**Кнопка:** "Очистить старые образы" (жёлтая)

**Команда:** `docker image prune -a -f`

**Что делает:**
- Удаляет все неиспользуемые Docker образы
- Освобождает место на диске
- Удаляет кэш сборки

**Когда использовать:**
- Когда заканчивается место на диске
- После множества пересборок
- Для "очистки" Docker

**Время выполнения:** 10-30 секунд

**Предупреждение:** 
- ⚠️ Следующая сборка будет медленнее
- ⚠️ Удалит ВСЕ неиспользуемые образы (не только HomeCenter)

**Освобождает:** Обычно 1-5 GB

---

## Лог операций

**Расположение:** Внизу окна, общий для всех вкладок

**Что показывает:**
- Все действия с временными метками
- Прогресс выполнения
- Ошибки и предупреждения
- Результаты операций

**Формат:** `[HH:mm:ss] Сообщение`

**Пример:**
```
[15:30:45] Проверка контейнера...
[15:30:46] Проверка базы данных...
[15:30:46] Создание бэкапа: quiz-20240214-153045.db
[15:30:47] ✓ Бэкап создан: quiz-20240214-153045.db (256.50 KB)
```

---

## Прогресс-бар и статус

**Прогресс-бар:** Показывается справа от лога во время длительных операций

**Статус:**
- "Готов" (зелёный) - приложение готово к работе
- "Работаю..." (оранжевый) - выполняется операция

**Блокировка:** Во время выполнения операции все кнопки заблокированы

---

## Диалоги подтверждения

### Восстановление бэкапа

```
⚠️ ВНИМАНИЕ! Это заменит текущую базу данных!

Будет восстановлен бэкап:
quiz-20240214-120000.db

Текущая база будет сохранена как резервная копия.

Продолжить?
```

### Остановка контейнера

```
Остановить контейнер?

Приложение станет недоступным до запуска.
```

### Пересборка без кэша

```
⚠️ ВНИМАНИЕ: Это медленная операция!

Команды:
1. docker-compose build --no-cache
2. docker-compose up -d

Это займёт 5-10 минут.

Продолжить?
```

### Очистка образов

```
⚠️ ВНИМАНИЕ:
- Удалит все неиспользуемые образы
- Освободит место на диске
- Следующая сборка будет медленнее

Команда: docker image prune -a -f

Продолжить?
```

---

## Рекомендации по использованию

### Ежедневно
- Создавайте бэкап базы данных

### Еженедельно
- Проверяйте логи контейнера
- Очищайте старые бэкапы

### Ежемесячно
- Обновляйте базовые образы
- Тестируйте восстановление из бэкапа

### При проблемах
1. Проверьте логи контейнера
2. Перезапустите контейнер
3. Если не помогло - полная пересборка
4. Если всё ещё проблемы - пересборка без кэша

### Перед обновлением
1. Создайте бэкап
2. Остановите контейнер
3. Обновите код
4. Пересоберите приложение
5. Проверьте что всё работает

### Экономия места
1. Очистите старые бэкапы (>30 дней)
2. Очистите старые Docker образы
3. Используйте `docker system prune` (вручную в терминале)
